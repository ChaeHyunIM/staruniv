/* StarUniv Global Styles */

@layer reset, base, components, pages;

/* ─── Reset ─── */
@layer reset {
  *,
  *::before,
  *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    min-height: 100dvh;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
  }

  img,
  svg {
    display: block;
    max-width: 100%;
  }

  a {
    color: inherit;
    text-decoration: none;
  }

  button,
  input,
  select,
  textarea {
    font: inherit;
    color: inherit;
  }

  ul,
  ol {
    list-style: none;
  }

  table {
    border-collapse: collapse;
    width: 100%;
  }
}

/* ─── Base ─── */
@layer base {
  :root {
    /* ── Surface (warm pink-beige) ── */
    --background: oklch(0.985 0.003 30);
    --foreground: oklch(0.15 0.005 30);
    --card: oklch(0.997 0.002 30);
    --card-foreground: oklch(0.15 0.005 30);
    --muted: oklch(0.96 0.003 30);
    --muted-foreground: oklch(0.4 0.005 30);
    --popover: oklch(0.997 0.002 30);
    --popover-foreground: oklch(0.15 0.005 30);

    /* ── Brand ── */
    --primary: oklch(0.7297 0.1384 260.5699);
    --primary-foreground: oklch(1 0 0);
    --secondary: oklch(0.6332 0.146 132.7937);
    --secondary-foreground: oklch(1 0 0);
    --accent: oklch(0.7686 0.1647 70.0804);
    --accent-foreground: oklch(0 0 0);
    --destructive: oklch(0.6368 0.2078 25.3313);
    --destructive-foreground: oklch(1 0 0);

    /* ── UI ── */
    --border: oklch(0 0 0);
    --border-10: oklch(from var(--border) l c h / 0.1);
    --border-15: oklch(from var(--border) l c h / 0.15);
    --input: oklch(0.5555 0 0);
    --ring: oklch(0.7853 0.1041 274.7134);

    /* ── Chart ── */
    --chart-1: oklch(0.7297 0.1384 260.5699);
    --chart-2: oklch(0.6332 0.146 132.7937);
    --chart-3: oklch(0.7686 0.1647 70.0804);
    --chart-4: oklch(0.6368 0.2078 25.3313);
    --chart-5: oklch(0.7853 0.1041 274.7134);

    /* ── Success ── */
    --success: oklch(0.72 0.17 142);

    /* ── Race colors (light) ── */
    --race-terran: oklch(0.55 0.18 255);
    --race-zerg: oklch(0.52 0.2 25);
    --race-protoss: oklch(0.6 0.16 80);
    --race-terran-bg: oklch(0.55 0.18 255 / 0.08);
    --race-zerg-bg: oklch(0.52 0.2 25 / 0.08);
    --race-protoss-bg: oklch(0.6 0.16 80 / 0.08);

    /* ── Tier colors (light) ── */
    --tier-god: oklch(0.62 0.16 85);
    --tier-king: oklch(0.58 0.14 75);
    --tier-jack: oklch(0.52 0.1 60);
    --tier-joker: oklch(0.52 0.16 300);
    --tier-spade: oklch(0.5 0.12 230);
    --tier-0: oklch(0.52 0.14 155);
    --tier-1: oklch(0.5 0.12 155);
    --tier-2: oklch(0.48 0.1 155);
    --tier-3: oklch(0.52 0.12 200);
    --tier-4: oklch(0.5 0.1 200);
    --tier-5: oklch(0.48 0.08 200);
    --tier-6: oklch(0.5 0.12 260);
    --tier-7: oklch(0.48 0.1 260);
    --tier-8: oklch(0.46 0.08 260);
    --tier-baby: oklch(0.58 0.14 350);

    --tier-god-bg: oklch(0.62 0.16 85 / 0.08);
    --tier-king-bg: oklch(0.58 0.14 75 / 0.08);
    --tier-jack-bg: oklch(0.52 0.1 60 / 0.08);
    --tier-joker-bg: oklch(0.52 0.16 300 / 0.08);
    --tier-spade-bg: oklch(0.5 0.12 230 / 0.08);
    --tier-0-bg: oklch(0.52 0.14 155 / 0.08);
    --tier-1-bg: oklch(0.5 0.12 155 / 0.08);
    --tier-2-bg: oklch(0.48 0.1 155 / 0.08);
    --tier-3-bg: oklch(0.52 0.12 200 / 0.08);
    --tier-4-bg: oklch(0.5 0.1 200 / 0.08);
    --tier-5-bg: oklch(0.48 0.08 200 / 0.08);
    --tier-6-bg: oklch(0.5 0.12 260 / 0.08);
    --tier-7-bg: oklch(0.48 0.1 260 / 0.08);
    --tier-8-bg: oklch(0.46 0.08 260 / 0.08);
    --tier-baby-bg: oklch(0.58 0.14 350 / 0.08);

    /* ── Tag colors (light) ── */
    --tag-promotion: oklch(0.58 0.16 55);
    --tag-rising: oklch(0.52 0.14 145);
    --tag-new: oklch(0.55 0.14 255);
    --tag-inactive: oklch(0.5 0.02 0);
    --tag-promotion-bg: oklch(0.58 0.16 55 / 0.1);
    --tag-rising-bg: oklch(0.52 0.14 145 / 0.1);
    --tag-new-bg: oklch(0.55 0.14 255 / 0.1);
    --tag-inactive-bg: oklch(0.5 0.02 0 / 0.1);

    /* ── Font ── */
    --font-sans: "Pretendard Variable", Pretendard, system-ui, sans-serif;
    --font-mono: ui-monospace, "SF Mono", SFMono-Regular, Menlo, Consolas, monospace;

    /* ── Radius ── */
    --radius: 1rem;
    --radius-sm: calc(var(--radius) - 4px);
    --radius-md: calc(var(--radius) - 2px);
    --radius-lg: var(--radius);
    --radius-xl: calc(var(--radius) + 4px);

    /* ── Shadow ── */
    --shadow-sm: 0 1px 2px oklch(0 0 0 / 0.04);
    --shadow-md: 0 2px 6px oklch(0 0 0 / 0.08);
    --shadow-lg: 0 4px 16px oklch(0 0 0 / 0.12);
    --shadow-xl: 0 8px 24px oklch(0 0 0 / 0.16);
    --shadow-2xl: 0 16px 48px oklch(0 0 0 / 0.2);

    /* ── Spacing ── */
    --sp-1: 0.25rem;
    --sp-2: 0.5rem;
    --sp-3: 0.75rem;
    --sp-4: 1rem;
    --sp-5: 1.25rem;
    --sp-6: 1.5rem;
    --sp-8: 2rem;
    --sp-10: 2.5rem;
    --sp-12: 3rem;
    --sp-16: 4rem;

    /* ── Typography ── */
    --text-xs: 0.75rem;
    --text-sm: 0.8125rem;
    --text-base: 0.9375rem;
    --text-lg: 1.125rem;
    --text-xl: 1.3125rem;
    --text-2xl: 1.625rem;
    --text-3xl: 2rem;

    --leading-tight: 1.2;
    --leading-normal: 1.5;
    --leading-relaxed: 1.65;

    /* ── Layout ── */
    --content-width: 1200px;
    --nav-height: 56px;
  }

  .dark {
    /* ── Surface (softer dark) ── */
    --background: oklch(0.205 0.006 280);
    --foreground: oklch(0.95 0 0);
    --card: oklch(0.235 0.006 280);
    --card-foreground: oklch(0.95 0 0);
    --muted: oklch(0.3 0.006 280);
    --muted-foreground: oklch(0.68 0 0);
    --popover: oklch(0.235 0.006 280);
    --popover-foreground: oklch(0.95 0 0);

    /* ── Brand ── */
    --primary: oklch(0.7297 0.1384 260.5699);
    --primary-foreground: oklch(1 0 0);
    --secondary: oklch(0.6332 0.146 132.7937);
    --secondary-foreground: oklch(1 0 0);
    --accent: oklch(0.7686 0.1647 70.0804);
    --accent-foreground: oklch(0 0 0);
    --destructive: oklch(0.6368 0.2078 25.3313);
    --destructive-foreground: oklch(1 0 0);

    /* ── UI ── */
    --border: oklch(1 0 0);
    --border-10: oklch(from var(--border) l c h / 0.1);
    --border-15: oklch(from var(--border) l c h / 0.15);
    --input: oklch(0.5555 0 0);
    --ring: oklch(0.7853 0.1041 274.7134);

    /* ── Chart ── */
    --chart-1: oklch(0.7297 0.1384 260.5699);
    --chart-2: oklch(0.6332 0.146 132.7937);
    --chart-3: oklch(0.7686 0.1647 70.0804);
    --chart-4: oklch(0.6368 0.2078 25.3313);
    --chart-5: oklch(0.7853 0.1041 274.7134);

    /* ── Success ── */
    --success: oklch(0.78 0.18 142);

    /* ── Race colors (dark) ── */
    --race-terran: oklch(0.72 0.15 255);
    --race-zerg: oklch(0.68 0.18 25);
    --race-protoss: oklch(0.78 0.14 85);
    --race-terran-bg: oklch(0.72 0.15 255 / 0.12);
    --race-zerg-bg: oklch(0.68 0.18 25 / 0.12);
    --race-protoss-bg: oklch(0.6 0.16 80 / 0.12);

    /* ── Tier colors (dark) ── */
    --tier-god: oklch(0.82 0.14 85);
    --tier-king: oklch(0.78 0.12 75);
    --tier-jack: oklch(0.7 0.08 60);
    --tier-joker: oklch(0.72 0.14 300);
    --tier-spade: oklch(0.68 0.1 230);
    --tier-0: oklch(0.72 0.12 155);
    --tier-1: oklch(0.7 0.1 155);
    --tier-2: oklch(0.68 0.08 155);
    --tier-3: oklch(0.72 0.1 200);
    --tier-4: oklch(0.7 0.08 200);
    --tier-5: oklch(0.68 0.06 200);
    --tier-6: oklch(0.7 0.1 260);
    --tier-7: oklch(0.68 0.08 260);
    --tier-8: oklch(0.66 0.06 260);
    --tier-baby: oklch(0.78 0.12 350);

    --tier-god-bg: oklch(0.82 0.14 85 / 0.12);
    --tier-king-bg: oklch(0.78 0.12 75 / 0.12);
    --tier-jack-bg: oklch(0.7 0.08 60 / 0.12);
    --tier-joker-bg: oklch(0.72 0.14 300 / 0.12);
    --tier-spade-bg: oklch(0.68 0.1 230 / 0.12);
    --tier-0-bg: oklch(0.72 0.12 155 / 0.12);
    --tier-1-bg: oklch(0.7 0.1 155 / 0.12);
    --tier-2-bg: oklch(0.68 0.08 155 / 0.12);
    --tier-3-bg: oklch(0.72 0.1 200 / 0.12);
    --tier-4-bg: oklch(0.7 0.08 200 / 0.12);
    --tier-5-bg: oklch(0.68 0.06 200 / 0.12);
    --tier-6-bg: oklch(0.7 0.1 260 / 0.12);
    --tier-7-bg: oklch(0.68 0.08 260 / 0.12);
    --tier-8-bg: oklch(0.66 0.06 260 / 0.12);
    --tier-baby-bg: oklch(0.78 0.12 350 / 0.12);

    /* ── Tag colors (dark) ── */
    --tag-promotion: oklch(0.75 0.14 55);
    --tag-rising: oklch(0.7 0.12 145);
    --tag-new: oklch(0.72 0.12 255);
    --tag-inactive: oklch(0.6 0.02 0);
    --tag-promotion-bg: oklch(0.75 0.14 55 / 0.15);
    --tag-rising-bg: oklch(0.7 0.12 145 / 0.15);
    --tag-new-bg: oklch(0.72 0.12 255 / 0.15);
    --tag-inactive-bg: oklch(0.6 0.02 0 / 0.15);

    /* ── Shadow (stronger for dark) ── */
    --shadow-sm: 0 1px 2px oklch(0 0 0 / 0.2);
    --shadow-md: 0 2px 6px oklch(0 0 0 / 0.3);
    --shadow-lg: 0 4px 16px oklch(0 0 0 / 0.4);
    --shadow-xl: 0 8px 24px oklch(0 0 0 / 0.5);
    --shadow-2xl: 0 16px 48px oklch(0 0 0 / 0.6);
  }

  html {
    color-scheme: light;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }

  html.dark {
    color-scheme: dark;
  }

  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  body {
    font-family: var(--font-sans);
    font-size: var(--text-base);
    line-height: var(--leading-normal);
    color: var(--foreground);
    background: var(--background);
  }

  h1,
  h2,
  h3,
  h4 {
    font-family: var(--font-sans);
    font-weight: 600;
    line-height: var(--leading-tight);
    letter-spacing: -0.01em;
    color: var(--foreground);
    text-wrap: balance;
    scroll-margin-top: calc(var(--nav-height) + var(--sp-4));
  }

  h1 {
    font-size: var(--text-3xl);
  }
  h2 {
    font-size: var(--text-2xl);
  }
  h3 {
    font-size: var(--text-xl);
  }
  h4 {
    font-size: var(--text-lg);
  }

  /* Scrollbar */
  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  ::-webkit-scrollbar-track {
    background: var(--muted);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--input);
    border-radius: 3px;

    &:hover {
      background: var(--muted-foreground);
    }
  }

  /* Focus visible */
  :focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 2px;
  }

  /* Selection */
  ::selection {
    background: var(--primary);
    color: var(--primary-foreground);
  }
}

/* ─── Components ─── */
@layer components {
  /* Page wrapper */
  .page {
    max-width: var(--content-width);
    margin-inline: auto;
    padding: var(--sp-8) var(--sp-6);
  }

  .page--narrow {
    max-width: 900px;
  }
  .page--detail {
    max-width: 720px;
  }

  .page-header {
    margin-bottom: var(--sp-8);

    & h1 {
      display: flex;
      align-items: center;
      gap: var(--sp-3);

      &::before {
        content: "";
        display: inline-block;
        width: 4px;
        height: 1em;
        background: var(--primary);
        border-radius: 2px;
      }
    }

    & p {
      margin-top: var(--sp-2);
      color: var(--muted-foreground);
      font-size: var(--text-sm);
    }
  }

  /* Back link */
  .back-link {
    display: inline-flex;
    align-items: center;
    gap: var(--sp-2);
    font-size: var(--text-sm);
    color: var(--muted-foreground);
    margin-bottom: var(--sp-6);
    transition: color 0.15s;

    &:hover {
      color: var(--foreground);
    }
  }

  /* Card */
  .card {
    background: var(--card);
    border: 1px solid oklch(from var(--border) l c h / 0.15);
    border-radius: var(--radius-md);
    padding: var(--sp-5);
    transition: border-color 0.15s;

    &:hover {
      border-color: oklch(from var(--border) l c h / 0.25);
    }
  }

  /* Table */
  .table-wrap {
    overflow-x: auto;
    border: 1px solid oklch(from var(--border) l c h / 0.15);
    border-radius: var(--radius-md);
    background: var(--card);
  }

  table {
    & th {
      font-family: var(--font-sans);
      font-size: var(--text-xs);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--muted-foreground);
      padding: var(--sp-3) var(--sp-4);
      text-align: left;
      background: var(--muted);
      border-bottom: 1px solid oklch(from var(--border) l c h / 0.15);
      white-space: nowrap;
    }

    & td {
      padding: var(--sp-3) var(--sp-4);
      border-bottom: 1px solid oklch(from var(--border) l c h / 0.1);
      font-size: var(--text-sm);
      font-variant-numeric: tabular-nums;
    }

    & tbody tr {
      transition: background-color 0.1s;

      &:hover {
        background: oklch(from var(--muted) l c h / 0.5);
      }

      &:last-child td {
        border-bottom: none;
      }
    }
  }

  /* Link style */
  .link {
    color: var(--primary);
    transition: color 0.15s;

    &:hover {
      color: var(--ring);
    }
  }

  /* Empty state */
  .empty-state {
    text-align: center;
    padding: var(--sp-16) var(--sp-8);
    color: var(--muted-foreground);
    font-size: var(--text-sm);
  }

  /* Loading */
  .loading {
    text-align: center;
    padding: var(--sp-16) var(--sp-8);
    color: var(--muted-foreground);
    font-size: var(--text-sm);

    &::after {
      content: "";
      display: block;
      width: 24px;
      height: 24px;
      margin: var(--sp-4) auto 0;
      border: 2px solid oklch(from var(--border) l c h / 0.2);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
  }

  /* Skip link */
  .skip-link {
    position: absolute;
    top: -100%;
    left: var(--sp-4);
    z-index: 200;
    padding: var(--sp-2) var(--sp-4);
    background: var(--primary);
    color: var(--primary-foreground);
    font-family: var(--font-sans);
    font-size: var(--text-sm);
    font-weight: 600;
    border-radius: var(--radius-sm);
    transition: top 0.15s;

    &:focus {
      top: var(--sp-2);
    }
  }

  /* Tier text color */
  .tier-color[data-tier="God"] {
    color: var(--tier-god);
  }
  .tier-color[data-tier="King"] {
    color: var(--tier-king);
  }
  .tier-color[data-tier="Jack"] {
    color: var(--tier-jack);
  }
  .tier-color[data-tier="Joker"] {
    color: var(--tier-joker);
  }
  .tier-color[data-tier="Spade"] {
    color: var(--tier-spade);
  }
  .tier-color[data-tier="0"] {
    color: var(--tier-0);
  }
  .tier-color[data-tier="1"] {
    color: var(--tier-1);
  }
  .tier-color[data-tier="2"] {
    color: var(--tier-2);
  }
  .tier-color[data-tier="3"] {
    color: var(--tier-3);
  }
  .tier-color[data-tier="4"] {
    color: var(--tier-4);
  }
  .tier-color[data-tier="5"] {
    color: var(--tier-5);
  }
  .tier-color[data-tier="6"] {
    color: var(--tier-6);
  }
  .tier-color[data-tier="7"] {
    color: var(--tier-7);
  }
  .tier-color[data-tier="8"] {
    color: var(--tier-8);
  }
  .tier-color[data-tier="Baby"] {
    color: var(--tier-baby);
  }

  /* Responsive */
  @media (max-width: 640px) {
    .page {
      padding: var(--sp-6) var(--sp-4);
    }
  }

  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }
}

/* ─── Driver.js tour theme ─── */
.tier-tour-popover {
  --dp-bg-color: var(--card);
  --dp-text-color: var(--foreground);

  background: var(--card);
  color: var(--foreground);
  border: 1px solid oklch(from var(--border) l c h / 0.15);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-xl);
  font-family: var(--font-sans);

  & .driver-popover-title {
    font-size: var(--text-sm);
    font-weight: 600;
  }

  & .driver-popover-description {
    font-size: var(--text-xs);
    line-height: var(--leading-relaxed);
    color: var(--muted-foreground);
  }

  & .driver-popover-progress-text {
    font-family: var(--font-mono);
    font-size: var(--text-xs);
    color: var(--muted-foreground);
  }

  & .driver-popover-prev-btn,
  & .driver-popover-next-btn {
    font-family: var(--font-sans);
    font-size: var(--text-xs);
    font-weight: 600;
    border-radius: var(--radius-sm);
    text-shadow: none;
  }

  & .driver-popover-next-btn {
    background: var(--primary);
    color: var(--primary-foreground);
    border: none;

    &:hover {
      background: oklch(from var(--primary) calc(l - 0.08) c h);
    }
  }

  & .driver-popover-prev-btn {
    background: transparent;
    color: var(--muted-foreground);
    border: 1px solid oklch(from var(--border) l c h / 0.15);
  }

  & .driver-popover-close-btn {
    color: var(--muted-foreground);

    &:hover {
      color: var(--foreground);
    }
  }

  & .driver-popover-arrow-side-left,
  & .driver-popover-arrow-side-right,
  & .driver-popover-arrow-side-top,
  & .driver-popover-arrow-side-bottom {
    border-color: oklch(from var(--border) l c h / 0.15);
  }
}
